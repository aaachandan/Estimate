<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Ray Services | Service Estimate</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<style>
*{box-sizing:border-box}

body{
    margin:0;
    padding:0;
    background:#eef2f6;
    font-family:"Segoe UI", Arial, sans-serif;
    color:#222;
}

.wrapper{
    display:flex;
    justify-content:center;
    padding:8px;
}

.page{
    width:185mm;
    background:#fff;
    padding:8mm 12mm;
    box-shadow:0 4px 14px rgba(0,0,0,.08);
}

.title{
    text-align:center;
    font-size:17px;
    font-weight:700;
    letter-spacing:1px;
    margin-bottom:6px;
}

/* TOP DETAILS */
.top{
    display:flex;
    justify-content:space-between;
    gap:14px;
    border-bottom:2px solid #2c5364;
    padding-bottom:6px;
}
.box{
    width:50%;
    font-size:13.5px;
}
.box b{font-size:14.5px}
.box p{margin:2px 0}
.box input{
    width:100%;
    border:none;
    border-bottom:1px solid #999;
    font-size:13.5px;
    padding:2px;
    outline:none;
    margin-top:3px;
}

/* DATE */
.date{
    font-size:13px;
    margin-bottom:4px;
}

/* TABLE */
table{
    width:100%;
    border-collapse:collapse;
    margin-top:12px;
    font-size:13.5px;
    table-layout:fixed;
}
th,td{
    border:1px solid #aaa;
    padding:6px;
    text-align:center;
}
th{background:#f1f5f9}
td input{
    width:100%;
    border:none;
    outline:none;
    font-size:13.5px;
    text-align:center;
}
.right{
    text-align:center;
    font-weight:600;
    background:#f8fafc;
}

.col-sno{width:7%}
.col-desc{width:40%}
.col-qty{width:11%}
.col-rate{width:20%}
.col-amt{width:22%}

.actions{margin-top:6px}
.add-row{
    background:#e3eef6;
    border:1px solid #9bbcd1;
    padding:4px 10px;
    cursor:pointer;
    font-size:12.5px;
}

.assurance{
    margin-top:8px;
    font-style:italic;
    font-size:12.5px;
}
.response{
    text-align:center;
    font-size:12px;
    color:#555;
}
.terms{
    font-size:12px;
    line-height:1.45;
}

.pdf-btn{
    background:#2c5364;
    color:#fff;
    border:none;
    padding:6px 16px;
    font-size:13px;
    cursor:pointer;
    margin:10px auto 0;
    display:block;
}

@media print{.pdf-btn{display:none}}
</style>
</head>

<body>

<div class="wrapper">
<div class="page" id="estimate">

<div class="title">SERVICE ESTIMATE</div>

<div class="top">
    <!-- LEFT -->
    <div class="box">
        <div class="date"><b>Date:</b> <input id="date"></div>
        <b>Ray Services</b>
        <p>Ayodhya Nagar, Santoshi Nagar,</p>
        <p>Mathpurena, Raipur 492013 (C.G.)</p>
        <p>Email: rayservices.cg@gmail.com</p>
        <p>Mobile: 7746969000, 9713511999</p>
    </div>

    <!-- RIGHT -->
    <div class="box">
        <b>Client Details</b>
        <input placeholder="Client Name">
        <input placeholder="Mobile Number">
        <input placeholder="Address">
    </div>
</div>

<table id="estimateTable">
<thead>
<tr>
    <th class="col-sno">S.No</th>
    <th class="col-desc">Service Description</th>
    <th class="col-qty">Qty / Sq Ft</th>
    <th class="col-rate">Rate (â‚¹)</th>
    <th class="col-amt">Amount (â‚¹)</th>
</tr>
</thead>

<tbody>
<tr>
    <td><input value="1"></td>
    <td><input></td>
    <td><input type="number" oninput="calc(this)"></td>
    <td><input type="number" oninput="calc(this)"></td>
    <td><input class="amt" readonly></td>
</tr>
</tbody>

<tr>
    <td colspan="4" class="right">Total</td>
    <td><input id="grand" readonly></td>
</tr>
</table>

<div class="actions">
<button class="add-row" onclick="addRow()">+ Add Row</button>
</div>

<div class="assurance">
We assure quality workmanship with complete safety and cleanliness standards.
</div>

<div class="response">
--------------------------- (We are waiting for your response) ----------------------------
</div>

<div class="terms">
<b>Terms & Conditions</b><br><br>
1. Prices inclusive of GST @18%.<br>
2. 100% advance payment required.<br>
3. Delivery within 7 days.<br>
4. Installation & transport extra.<br>
5. Estimate valid for 7 days.<br><br>
<b>MSME:</b> UDYAM-CG-14-0116772
</div>

<button class="pdf-btn" onclick="downloadPDF()">ðŸ“„ Service Estimate</button>

</div>
</div>

<script>
/* AUTO DATE */
let d = new Date();
document.getElementById("date").value =
  String(d.getDate()).padStart(2,'0') + "/" +
  String(d.getMonth()+1).padStart(2,'0') + "/" +
  d.getFullYear();

let rowNo = 1;

function addRow(){
    rowNo++;
    let tbody = document.querySelector("#estimateTable tbody");
    let tr = document.createElement("tr");
    tr.innerHTML = `
        <td><input value="${rowNo}"></td>
        <td><input></td>
        <td><input type="number" oninput="calc(this)"></td>
        <td><input type="number" oninput="calc(this)"></td>
        <td><input class="amt" readonly></td>`;
    tbody.appendChild(tr);
}

function calc(el){
    let row = el.closest("tr");
    let qty = row.cells[2].querySelector("input").value || 0;
    let rate = row.cells[3].querySelector("input").value || 0;
    row.cells[4].querySelector("input").value = qty * rate;
    total();
}

function total(){
    let sum = 0;
    document.querySelectorAll(".amt").forEach(a=>sum+=Number(a.value||0));
    document.getElementById("grand").value = sum;
}

function downloadPDF(){
    html2pdf().from(document.getElementById("estimate")).set({
        filename:'Ray_Services_Service_Estimate.pdf',
        margin:[6,12,6,12],
        html2canvas:{scale:2},
        jsPDF:{unit:'mm',format:'a4',orientation:'portrait'}
    }).save();
}
</script>

</body>
</html>