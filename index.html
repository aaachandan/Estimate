<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>RAY SERVICES | Service Estimate</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<style>
*{box-sizing:border-box}
body{
    margin:0;
    padding:0;
    background:#eef2f6;
    font-family:"Segoe UI", Arial, sans-serif;
    color:#222;
}
.wrapper{
    width:100%;
    display:flex;
    justify-content:center;
    align-items:flex-start;
}
.page{
    width:190mm;
    margin:10mm auto;
    background:#fff;
    padding:10mm 12mm;
    box-shadow:0 4px 14px rgba(0,0,0,.08);
}

/* TITLE */
.title{
    text-align:center;
    font-size:18px;
    font-weight:800;
    margin-bottom:6px;
}

/* META */
.meta-line{
    display:flex;
    justify-content:space-between;
    font-size:13px;
    margin-bottom:6px;
}
.meta-line input{
    border:none;
    border-bottom:1px solid #999;
    font-size:13px;
    width:140px;
    outline:none;
}

/* TOP INFO */
.top{
    display:flex;
    gap:14px;
    border-bottom:2px solid #2c5364;
    padding-bottom:6px;
}
.box{width:50%;font-size:13.5px}
.box b{font-size:14.5px}
.box p{margin:2px 0}
.box input{
    width:100%;
    border:none;
    border-bottom:1px solid #999;
    font-size:13.5px;
}

/* TABLE */
table{
    width:100%;
    border-collapse:collapse;
    margin-top:12px;
    font-size:13.5px;
    table-layout:fixed;
}
th,td{
    border:1px solid #aaa;
    padding:6px;
    vertical-align:middle;
}

/* HEADER ALIGN */
th.col-sno,
th.col-qty,
th.col-rate,
th.col-amt{
    text-align:center;
}
th.col-desc{ text-align:left; }

/* ROW ALIGN */
td.col-sno input,
td.col-qty input,
td.col-rate input,
td.col-amt input{
    text-align:center;
}
td.col-desc input{
    text-align:left;
    padding-left:6px;
}
td input{
    width:100%;
    border:none;
    font-size:13.5px;
}

/* COLUMN WIDTHS */
.col-sno{width:8%}
.col-desc{width:51%}
.col-qty{width:13%}
.col-rate{width:14%}
.col-amt{width:14%}

/* TOTAL ROW */
.total-label{
    text-align:center;
    font-weight:700;
    background:#f8fafc;
}
.total-amount input{
    text-align:center;
    font-weight:700;
}

/* ACTIONS */
.actions{margin-top:6px}
.add-row{
    background:#e3eef6;
    border:1px solid #9bbcd1;
    padding:5px 12px;
    font-size:13px;
}

/* TEXT */
.amount-words{margin-top:6px;font-size:13px;font-weight:700}
.assurance{
    margin-top:10px;
    font-size:13px;
    font-weight:600;
    line-height:1.6;
    text-indent:28px;
}
.response{
    text-align:center;
    font-size:12px;
    color:#555;
    margin:8px 0;
}
.terms{font-size:12px;line-height:1.45}

/* NOTE */
.note-wrap{
    display:grid;
    grid-template-columns:auto 1fr;
    column-gap:6px;
}
.note-label{font-weight:700;white-space:nowrap}
.note-text span{display:block}
.msme-line{color:#ff6f00;font-weight:700}
.ngo-line{color:#138808;font-weight:700}

/* BUTTON */
.pdf-btn{
    background:#2c5364;
    color:#fff;
    border:none;
    padding:6px 16px;
    font-size:13px;
    cursor:pointer;
    margin:10px auto 0;
    display:block;
}

@media print{
    body{background:#fff}
    .pdf-btn,.add-row{display:none}
}
</style>
</head>

<body>
<div class="wrapper">
<div class="page" id="estimate">

<div class="title">SERVICE ESTIMATE</div>

<div class="meta-line">
    <div><b>Estimate No:</b> <input value="D/R/C/01"></div>
    <div><b>Date:</b> <input id="date" readonly></div>
</div>

<div class="top">
    <div class="box">
        <b>RAY SERVICES</b>
        <p>Ayodhya Nagar, Santoshi Nagar,</p>
        <p>Mathpurena, Raipur 492013 (C.G.)</p>
        <p>Email ID: rayservices.cg@gmail.com</p>
        <p>Mobile No: 7746969000</p>
    </div>
    <div class="box">
        <b>Client Details</b>
        <input placeholder="Client Name">
        <input placeholder="Mobile Number">
        <input placeholder="Address">
    </div>
</div>

<table id="estimateTable">
<thead>
<tr>
    <th class="col-sno">S.No</th>
    <th class="col-desc">Service Description</th>
    <th class="col-qty">Qty / Sq Ft</th>
    <th class="col-rate">Rate (‚Çπ)</th>
    <th class="col-amt">Amount (‚Çπ)</th>
</tr>
</thead>

<tbody>
<tr>
    <td class="col-sno"><input value="1"></td>
    <td class="col-desc"><input></td>
    <td class="col-qty"><input type="number" oninput="calc(this)"></td>
    <td class="col-rate"><input type="number" oninput="calc(this)"></td>
    <td class="col-amt"><input class="amt" readonly></td>
</tr>
</tbody>

<tr>
    <td colspan="4" class="total-label">Total</td>
    <td class="col-amt total-amount"><input id="grand" readonly></td>
</tr>
</table>

<div class="actions">
<button class="add-row" onclick="addRow()">+ Add Row</button>
</div>

<div class="amount-words" id="amountWords">
Amount in Words: Rupees Zero Only
</div>

<div class="assurance">
We have over 8 years of professional experience, and we assure you that all work will be
carried out with the highest quality, safety standards, and complete cleanliness.
</div>

<div class="response">
--------------------------- (We are waiting for your response) ----------------------------
</div>

<div class="terms">
<b>Terms & Conditions</b><br>
1. Prices: Inclusive of GST @ 18%.<br>
2. Payment: 100% advance, in favor of ‚ÄúRAY SERVICES‚Äù (via Bank / UPI / Online Transfer).<br>
3. Delivery: Within 7 days from order confirmation.<br>
4. Transportation: Extra at actuals.<br>
5. Installation: Charges extra as applicable.<br>
6. Validity: This estimate is valid for 7 days from the date of issue.<br>
7. Work Order: Once confirmed, the order cannot be cancelled.<br>
8. Work Schedule: Government holidays will not be counted as working days.<br>
9. Liability: RAY SERVICES will not be responsible for any losses due to environmental or unforeseen circumstances<br>
10. Repair Work: No warranty or guarantee is applicable on any repair work. For products requiring warranty, customers are requested to provide the original warranty documents. RAY SERVICES is always committed to delivering the best service possible<br><br>

<div class="note-wrap">
    <div class="note-label">Note:</div>
    <div class="note-text">
        <span class="msme-line">Our firm is registered as an MSME Unit under Govt. of India. UDYAM-CG-14-0116772</span>
        <span class="ngo-line">As part of our commitment to social responsibility, service charges are waived for all registered NGOs contributing to nation building</span>
    </div>
</div>
</div>

<button class="pdf-btn" onclick="downloadPDF()">üìÑ Service Estimate</button>

</div>
</div>

<script>
const d=new Date();
document.getElementById("date").value=
String(d.getDate()).padStart(2,'0')+"/"+
String(d.getMonth()+1).padStart(2,'0')+"/"+
d.getFullYear();

let rowNo=1;
function addRow(){
    rowNo++;
    let tr=document.createElement("tr");
    tr.innerHTML=`
        <td class="col-sno"><input value="${rowNo}"></td>
        <td class="col-desc"><input></td>
        <td class="col-qty"><input type="number" oninput="calc(this)"></td>
        <td class="col-rate"><input type="number" oninput="calc(this)"></td>
        <td class="col-amt"><input class="amt" readonly></td>`;
    document.querySelector("#estimateTable tbody").appendChild(tr);
    total();
}

function calc(el){
    let r=el.closest("tr");
    let q=r.cells[2].querySelector("input").value||0;
    let rt=r.cells[3].querySelector("input").value||0;
    r.cells[4].querySelector("input").value=q*rt;
    total();
}

function numberToWords(num){
    if(num===0) return "Zero";
    const a=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine","Ten",
    "Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"];
    const b=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"];
    function inWords(n){
        if(n<20) return a[n];
        if(n<100) return b[Math.floor(n/10)] + (n%10?" "+a[n%10]:"");
        if(n<1000) return a[Math.floor(n/100)]+" Hundred"+(n%100?" "+inWords(n%100):"");
        if(n<100000) return inWords(Math.floor(n/1000))+" Thousand"+(n%1000?" "+inWords(n%1000):"");
        if(n<10000000) return inWords(Math.floor(n/100000))+" Lakh"+(n%100000?" "+inWords(n%100000):"");
        return inWords(Math.floor(n/10000000))+" Crore"+(n%10000000?" "+inWords(n%10000000):"");
    }
    return inWords(num);
}

function total(){
    let sum=0;
    document.querySelectorAll(".amt").forEach(a=>sum+=Number(a.value||0));
    document.getElementById("grand").value=sum;
    document.getElementById("amountWords").innerText=
        "Amount in Words: Rupees "+numberToWords(sum)+" Only";
}

function downloadPDF(){
    total();
    html2pdf().set({
        margin:0,
        filename:'Ray_Services_Estimate.pdf',
        image:{type:'jpeg',quality:1},
        html2canvas:{scale:3,dpi:300,letterRendering:true,useCORS:true},
        jsPDF:{unit:'mm',format:'a4',orientation:'portrait'}
    }).from(document.getElementById("estimate")).save();
}
</script>

</body>
</html>
