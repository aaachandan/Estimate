<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Ray Services | Service Estimate</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<style>
*{box-sizing:border-box}

body{
    margin:0;
    padding:0;
    background:#eef2f6;
    font-family:"Segoe UI", Arial, sans-serif;
    color:#222;
}

.wrapper{
    display:flex;
    justify-content:center;
    padding:8px;
}

.page{
    width:185mm;
    background:#fff;
    padding:8mm 12mm;
    box-shadow:0 4px 14px rgba(0,0,0,.08);
}

/* HEADER LINE */
.header-line{
    display:flex;
    justify-content:space-between;
    align-items:center;
    margin-bottom:6px;
}

.title{
    flex:1;
    text-align:center;
    font-size:17px;
    font-weight:700;
    letter-spacing:1px;
}

/* RIGHT INFO */
.top-right{
    text-align:right;
    font-size:12.5px;
    min-width:170px;
}
.top-right div{
    display:flex;
    justify-content:flex-end;
    gap:4px;
}
.top-right input{
    border:none;
    border-bottom:1px solid #999;
    font-size:12.5px;
    text-align:right;
    outline:none;
    width:130px;
}

/* TOP DETAILS */
.top{
    display:flex;
    justify-content:space-between;
    gap:14px;
    border-bottom:2px solid #2c5364;
    padding-bottom:6px;
}

.box{
    width:50%;
    font-size:13.5px;
}
.box b{font-size:14.5px}
.box p{margin:2px 0}
.box input{
    width:100%;
    border:none;
    border-bottom:1px solid #999;
    font-size:13.5px;
    padding:2px;
    outline:none;
    margin-top:3px;
}

/* TABLE */
table{
    width:100%;
    border-collapse:collapse;
    margin-top:12px;
    font-size:13.5px;
    table-layout:fixed;
}
th,td{
    border:1px solid #aaa;
    padding:6px;
    text-align:center;
}
th{background:#f1f5f9}
td input{
    width:100%;
    border:none;
    outline:none;
    font-size:13.5px;
    text-align:center;
}
.right{
    text-align:center;
    font-weight:600;
    background:#f8fafc;
}

.col-sno{width:7%}
.col-desc{width:40%}
.col-qty{width:11%}
.col-rate{width:20%}
.col-amt{width:22%}

.actions{margin-top:6px}
.add-row{
    background:#e3eef6;
    border:1px solid #9bbcd1;
    padding:4px 10px;
    cursor:pointer;
    font-size:12.5px;
}

.assurance{
    margin-top:8px;
    font-style:italic;
    font-size:12.5px;
}
.response{
    text-align:center;
    font-size:12px;
    color:#555;
}
.terms{
    font-size:12px;
    line-height:1.45;
    margin-top:2px;
}

.pdf-btn{
    background:#2c5364;
    color:#fff;
    border:none;
    padding:6px 16px;
    font-size:13px;
    cursor:pointer;
    margin:10px auto 0;
    display:block;
}

@media print{.pdf-btn{display:none}}
</style>
</head>

<body>

<div class="wrapper">
<div class="page" id="estimate">

<!-- HEADER -->
<div class="header-line">
    <div style="width:170px"></div>

    <div class="title">SERVICE ESTIMATE</div>

    <div class="top-right">
        <div><b>Date:</b><input id="date"></div>
        <div><b>Estimate No:</b><input id="estNo"></div>
    </div>
</div>

<div class="top">
    <div class="box">
        <b>Ray Services</b>
        <p>Ayodhya Nagar, Santoshi Nagar,</p>
        <p>Mathpurena, Raipur 492013 (C.G.)</p>
        <p>Email ID: rayservices.cg@gmail.com</p>
        <p>Mobile No: 7746969000, 9713511999</p>
    </div>

    <div class="box">
        <b>Client Details</b>
        <input placeholder="Client Name">
        <input placeholder="Mobile Number">
        <input placeholder="Address">
    </div>
</div>

<table id="estimateTable">
<thead>
<tr>
    <th class="col-sno">S.No</th>
    <th class="col-desc">Service Description</th>
    <th class="col-qty">Qty / Sq Ft</th>
    <th class="col-rate">Rate (‚Çπ)</th>
    <th class="col-amt">Amount (‚Çπ)</th>
</tr>
</thead>

<tbody>
<tr>
    <td><input value="1"></td>
    <td><input></td>
    <td><input type="number" oninput="calc(this)"></td>
    <td><input type="number" oninput="calc(this)"></td>
    <td><input class="amt" readonly></td>
</tr>
</tbody>

<tr>
    <td colspan="4" class="right">Total</td>
    <td><input id="grand" readonly></td>
</tr>
</table>

<div class="actions">
<button class="add-row" onclick="addRow()">+ Add Row</button>
</div>

<div class="assurance">
We have over 8 years of professional experience, and we assure you that all work will be carried out with the highest quality, safety standards, and complete cleanliness.
</div>

<div class="response">
--------------------------- (We are waiting for your response) ----------------------------
</div>

<!-- TERMS -->
<div class="terms">
<b>Terms & Conditions</b><br><br>

<b>1.</b> Prices: Inclusive of GST @ 18%.<br>
<b>2.</b> Payment: 100% advance, in favor of ‚ÄúRAY SERVICES‚Äù (via Bank / UPI / Online Transfer).<br>
<b>3.</b> Delivery: Within 7 days from order confirmation.<br>
<b>4.</b> Transportation: Extra at actuals.<br>
<b>5.</b> Installation: Charges extra as applicable.<br>
<b>6.</b> Validity: This estimate is valid for 7 days from the date of issue.<br>
<b>7.</b> Work Order: Once confirmed, the order cannot be cancelled.<br>
<b>8.</b> Work Schedule: Government holidays will not be counted as working days.<br>
<b>9.</b> Liability: RAY SERVICES will not be responsible for any losses due to environmental or unforeseen circumstances<br>
<b>10.</b> Repair Work: No warranty or guarantee is applicable on any repair work. For products requiring warranty, customers are requested to provide the original warranty documents. RAY SERVICES is always committed to delivering the best service possible<br><br>

<b>Note:</b> Our firm is registered as an MSME Unit under Govt. of India. UDYAM-CG-14-0116772
</div>

<button class="pdf-btn" onclick="downloadPDF()">üìÑ Service Estimate</button>

</div>
</div>

<script>
/* DATE DD/MM/YYYY */
let d = new Date();
document.getElementById("date").value =
  String(d.getDate()).padStart(2,'0') + "/" +
  String(d.getMonth()+1).padStart(2,'0') + "/" +
  d.getFullYear();

/* ESTIMATE NO FORMAT */
let monthLetter = d.toLocaleString('en-US',{month:'long'})[0].toUpperCase();
document.getElementById("estNo").value = `${monthLetter}/R/C/01`;

let rowNo = 1;

function addRow(){
    rowNo++;
    let tbody = document.querySelector("#estimateTable tbody");
    let tr = document.createElement("tr");
    tr.innerHTML = `
        <td><input value="${rowNo}"></td>
        <td><input></td>
        <td><input type="number" oninput="calc(this)"></td>
        <td><input type="number" oninput="calc(this)"></td>
        <td><input class="amt" readonly></td>`;
    tbody.appendChild(tr);
}

function calc(el){
    let row = el.closest("tr");
    let qty = row.cells[2].querySelector("input").value || 0;
    let rate = row.cells[3].querySelector("input").value || 0;
    row.cells[4].querySelector("input").value = qty * rate;
    total();
}

function total(){
    let sum = 0;
    document.querySelectorAll(".amt").forEach(a=>sum+=Number(a.value||0));
    document.getElementById("grand").value = sum;
}

function downloadPDF(){
    html2pdf().from(document.getElementById("estimate")).set({
        filename:'Ray_Services_Service_Estimate.pdf',
        margin:[6,12,6,12],
        html2canvas:{scale:2},
        jsPDF:{unit:'mm',format:'a4',orientation:'portrait'}
    }).save();
}
</script>

</body>
</html>